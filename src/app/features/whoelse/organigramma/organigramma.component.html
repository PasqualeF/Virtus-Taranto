<!-- organigramma.component.html - SENZA FOTO -->
<div class="organigramma-container">
  <h1 class="titolo">
    Organigramma Societario
    <span class="sottotitolo">Le persone dietro il nostro successo</span>
  </h1>

  <!-- Messaggio di errore -->
  <div *ngIf="error" class="error-container">
    <div class="error-message">
      <svg class="error-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <circle cx="12" cy="12" r="10"/>
        <line x1="15" y1="9" x2="9" y2="15"/>
        <line x1="9" y1="9" x2="15" y2="15"/>
      </svg>
      {{ error }}
      <button (click)="clearError()" class="error-close">×</button>
    </div>
    <button (click)="reloadData()" class="retry-button">
      <svg class="retry-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M23 4v6h-6M1 20v-6h6"/>
        <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4a9 9 0 0 1-14.85 4.36L14 14"/>
      </svg>
      Riprova
    </button>
  </div>

  <!-- Società Selector -->
  <div class="societa-selector" *ngIf="!loadingSocieta">
    <div *ngFor="let s of societaOptions" 
         class="societa-tab"
         [class.active]="isSocietaActive(s)"
         (click)="onSocietaClick(s)">
      <img [src]="s.logo" [alt]="s.nome" class="societa-logo">
      <span>{{ s.nome }}</span>
    </div>
  </div>

  <!-- Loading delle società -->
  <div *ngIf="loadingSocieta" class="loading-container">
    <div class="loader"></div>
    <span>Caricamento società...</span>
  </div>

  <!-- Loading State -->
  <div *ngIf="loadingStaff" class="loading-container">
    <div class="loader"></div>
    <span>Caricamento staff per {{ selectedSocieta }}...</span>
  </div>

  <!-- Messaggio quando non ci sono dati -->
  <div *ngIf="!hasData() && !isLoading() && !error" class="no-data-container">
    <svg class="no-data-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
      <circle cx="12" cy="12" r="10"/>
      <path d="M8 12h8"/>
    </svg>
    <h3>Nessun dato disponibile</h3>
    <p>Non sono stati trovati membri dello staff per {{ selectedSocieta }}</p>
    <button (click)="reloadData()" class="reload-button">
      <svg class="reload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M23 4v6h-6M1 20v-6h6"/>
        <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4a9 9 0 0 1-14.85 4.36L14 14"/>
      </svg>
      Ricarica
    </button>
  </div>

  <!-- Cards View - Senza foto -->
  <div *ngIf="hasData() && !isLoading()" class="staff-grid" [@staffCards]>
    <!-- Presidente Level -->
    <div *ngIf="hasDataForLevel(1)" class="level-section presidente-section" [class]="presidentCountClass">
      <div class="level-title">{{ getLevelTitle(1) }}</div>
      <div class="staff-cards">
        <div *ngFor="let member of getStaffByLevel(1)"
             class="staff-card presidente">
          
          <!-- Header con icona -->
          <div class="member-header">
            <div class="member-icon presidente-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            </div>
          </div>

          <!-- Contenuto membro -->
          <div class="member-content">
            <h3 class="member-name">{{ member.nome }}</h3>
            <span class="member-role">{{ member.ruolo }}</span>
            <p class="member-description" *ngIf="member.descrizione">{{ member.descrizione }}</p>
            
            <!-- Contatti -->
            <div class="member-contact">
              <a *ngIf="member.email" [href]="'mailto:' + member.email" class="contact-link">
                <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
                {{ member.email }}
              </a>
              <a *ngIf="member.telefono" [href]="'tel:' + member.telefono" class="contact-link">
                <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                </svg>
                {{ member.telefono }}
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Staff Tecnico -->
    <div *ngIf="hasDataForLevel(2)" class="level-section">
      <div class="level-title">{{ getLevelTitle(2) }}</div>
      <div class="staff-cards">
        <div *ngFor="let member of getStaffByLevel(2)" class="staff-card staff-tecnico">
          
          <div class="member-header">
            <div class="member-icon staff-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
              </svg>
            </div>
          </div>

          <div class="member-content">
            <h3 class="member-name">{{ member.nome }}</h3>
            <span class="member-role">{{ member.ruolo }}</span>
            <p class="member-description" *ngIf="member.descrizione">{{ member.descrizione }}</p>
            
            <div class="member-contact">
              <a *ngIf="member.email" [href]="'mailto:' + member.email" class="contact-link">
                <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
                {{ member.email }}
              </a>
              <a *ngIf="member.telefono" [href]="'tel:' + member.telefono" class="contact-link">
                <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                </svg>
                {{ member.telefono }}
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Dirigenza -->
    <div *ngIf="hasDataForLevel(3)" class="level-section">
      <div class="level-title">{{ getLevelTitle(3) }}</div>
      <div class="staff-cards">
        <div *ngFor="let member of getStaffByLevel(3)" class="staff-card dirigenza">
          
          <div class="member-header">
            <div class="member-icon dirigenza-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                <polyline points="3.27,6.96 12,12.01 20.73,6.96"/>
                <line x1="12" y1="22.08" x2="12" y2="12"/>
              </svg>
            </div>
          </div>

          <div class="member-content">
            <h3 class="member-name">{{ member.nome }}</h3>
            <span class="member-role">{{ member.ruolo }}</span>
            <p class="member-description" *ngIf="member.descrizione">{{ member.descrizione }}</p>
            
            <div class="member-contact">
              <a *ngIf="member.email" [href]="'mailto:' + member.email" class="contact-link">
                <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
                {{ member.email }}
              </a>
              <a *ngIf="member.telefono" [href]="'tel:' + member.telefono" class="contact-link">
                <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                </svg>
                {{ member.telefono }}
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Staff Medico -->
    <div *ngIf="hasDataForLevel(4)" class="level-section">
      <div class="level-title">{{ getLevelTitle(4) }}</div>
      <div class="staff-cards">
        <div *ngFor="let member of getStaffByLevel(4)" class="staff-card staff-medico">
          
          <div class="member-header">
            <div class="member-icon medico-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
              </svg>
            </div>
          </div>

          <div class="member-content">
            <h3 class="member-name">{{ member.nome }}</h3>
            <span class="member-role">{{ member.ruolo }}</span>
            <p class="member-description" *ngIf="member.descrizione">{{ member.descrizione }}</p>
            
            <div class="member-contact">
              <a *ngIf="member.email" [href]="'mailto:' + member.email" class="contact-link">
                <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                  <polyline points="22,6 12,13 2,6"/>
                </svg>
                {{ member.email }}
              </a>
              <a *ngIf="member.telefono" [href]="'tel:' + member.telefono" class="contact-link">
                <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                </svg>
                {{ member.telefono }}
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search functionality -->
  <div *ngIf="hasData() && !isLoading()" class="search-container">
    <div class="search-input-container">
      <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
      <input type="text" 
             placeholder="Cerca per nome o ruolo..." 
             #searchInput
             (input)="searchStaff(searchInput.value)"
             class="search-input">
    </div>
  </div>
</div>